$(function(e,n){"use strict";function t(){O.$continueBtn=O.$module.find(T.continueBtn),O.$backBtn=O.$module.find(T.backBtn),O.$radioBtn=O.$module.find(T.radioBtn),O.$submitBtn=O.$module.find(T.submitBtn),O.$textFields=O.$module.find(T.textFields),O.$lastStepFields=O.$module.find(T.lastStepFields),O.$lastStep=O.$module.find(T.lastStep),O.$disclaimer=O.$module.find(T.disclaimer),O.$payDate=O.$module.find(T.payDate),O.$email=O.$module.find(T.email),O.$requestedAmount=O.$module.find(T.requestedAmount),O.$minLoanAmount=O.$module.find(T.minLoanAmount),O.$phoneHome=O.$module.find(T.phoneHome),O.$phoneWork=O.$module.find(T.phoneWork),O.$employerZip=O.$module.find(T.employerZip),O.$zipCode=O.$module.find(T.zipCode),O.$bankABA=O.$module.find(T.bankABA),O.$ssn=O.$module.find(T.ssn),O.$ssn1=O.$module.find(T.ssn1),O.$mortgageRent=O.$module.find(T.mortgageRent),O.$mortgageRentMasked=O.$module.find(T.mortgageRentMasked),O.$annualIncome=O.$module.find(T.annualIncome),O.$annualIncomeMasked=O.$module.find(T.annualIncomeMasked),O.$returningConfirmation=O.$moduleReturning.find(T.returningConfirmation),O.$returningSubmit=O.$moduleReturning.find(T.returningSubmit),O.$submitNewBnt=O.$moduleReturning.find(T.submitNewBnt),O.$submitVerifyBnt=O.$moduleReturning.find(T.submitVerifyBnt),O.$submitReturningBnt=O.$moduleReturning.find(T.submitReturningBnt),O.$updateBnt=O.$moduleReturning.find(T.updateBnt),O.$returningZip=O.$moduleReturning.find(T.returningZip),O.$returningSsn=O.$moduleReturning.find(T.returningSsn),O.$returningDate=O.$moduleReturning.find(T.returningDate),O.$returningPayDate=O.$moduleReturning.find(T.returningPayDate),O.$returningAmount=O.$moduleReturning.find(T.returningAmount),O.$returningMinLoanAmount=O.$moduleReturning.find(T.returningMinLoanAmount),O.$processingBar=new ProgressBar.Line(T.processingBar,{easing:"linear",duration:15e3,color:"#FFEA82",trailColor:"#eee",svgStyle:{width:"100%",height:"100%"},text:{style:null},step:function(e,n){n.setText(Math.round(100*n.value())+" %")}})}function a(n){n>100&&(n=100),e(_.progressNum).text(n+"%"),e(_.progressLine).css("width",n+"%")}function r(n,t){var r,i=e(n),o=i.attr("name"),u=i.attr("type");_.requiredCount=e(Y+" "+_.requiredCountSelector).length,"radio"!==u&&"checkbox"!==u||i.closest(_.radioWrap).addClass(Z.valid),t?_.validFields[o]=!0:delete _.validFields[o];for(var l in _.validFields)_.validCount++;_.validCount=e(Y+" "+_.validCountSelector).length,r=Math.round(100*_.validCount/_.requiredCount),a(r)}function i(n){var t=e(n).closest(T.step);return!t.find(T.validatedFields).parent().hasClass(Z.loadingSM)&&t.find(T.validatedFields).valid()}function o(n){return e(n).closest(T.returningStep).find(T.returningFields).valid()}function u(e,n){e.toggle(n)}function l(e,n){e.toggle(n)}function d(e,n){e.toggleClass(Z.loading,n)}function s(n,t){e(n).parent().toggleClass(Z.loadingSM,t)}function m(e,n){u(e,!n),u(O.$moduleProcessing,n)}function p(e){return e.replace(/\D+/g,"")}function c(n){var t=e(n).closest(T.step),a=t.nextAll(Y).first();l(t,!1),l(a,!0),$(a)}function g(e){var n=O.$module.find('[name="'+e+'"]').closest(T.step);l(O.$lastStep,!1),l(n,!0),v(e)}function f(){var e,n=O.$module.find('[name="'+H[P]+'"]').closest(T.step);if(P===H.length-1)return l(n,!1),l(O.$lastStep,!0),void v(H[P]);P<H.length&&(l(n,!1),P++,e=O.$module.find('[name="'+H[P]+'"]').closest(T.step),l(e,!0),v(H[P]))}function h(n){var t=e(n).closest(T.step),a=t.prevAll(Y).first();l(t,!1),l(a,!0)}function $(e){var n=e.find(T.focusedFields)[0];n&&n.focus()}function v(e){var n=O.$module.find('[name="'+e+'"]');n&&n.focus()}function y(e,n){var t=new Date(e);return t.setDate(e.getDate()+n),t}function b(n){var t=e(n);t.attr("placeholder");t.find("option").length||n.append("<option value></option>");for(var a=1;a<=40;a++){var r=y(new Date,a);if(1!==a&&1!==r.getDate()||n.append("<option disabled>"+z.months[r.getMonth()]+" - "+r.getFullYear()+"</option>"),!ee(r)){var i=r.getDay();i>0&&i<6&&n.append('<option value="'+(r.getMonth()+1)+"/"+r.getDate()+"/"+r.getFullYear()+'">'+z.days[r.getDay()].substr(0,3)+" "+z.months[r.getMonth()].substr(0,3)+"-"+r.getDate()+"-"+r.getFullYear()+"</option>")}}}function k(e){Y=e<=K?T.payday:T.personal}function B(e){return e<=K?E.payday:E.personal}function R(e){return e<=K?W.payday:W.personal}function S(){var t=O.$module.find(Y+" input:not(.pp-dont-send),"+Y+" select").serialize();H=[],m(O.$module,!0),O.$processingBar.animate(.99),e.ajax({type:"POST",url:"lead.php",data:t,dataType:"json",success:function(t){Boolean(t.Errors&&t.Errors.length)&&(e.each(t.Errors,function(e,n){var t=O.$module.find("[name="+n.Field+"]");n.Field&&t.addClass(Z.error),-1===H.indexOf(n.Field)&&H.push(n.Field)}),P=0,m(O.$module,!1),g(H[P])),Boolean(t.RedirectURL)?n.location.href=t.RedirectURL:Boolean(t.LeadID)&&(X=t.LeadID,setTimeout(function(){A()},200))},error:function(e,n,t){console.error("The following error occurred: "+n,t)}})}function A(){var t="RequestedAmount="+e("[name=RequestedAmount]").val()+"&LeadID="+X;e.ajax({type:"POST",url:"leadcheck.php",data:t,dataType:"json",success:function(e){Boolean(e.RedirectURL)?n.location.href=e.RedirectURL:setTimeout(function(){A()},200)},error:function(e,n,t){console.error("The following error occurred: "+n,t)}})}function F(e){var n=e.closest(T.step).find(T.zipState);return n.length||(n=e.parent().after('<span class="'+Z.zipState+'"/>').next()),n}function D(e,n){var t=Boolean(e.Conversion&&1===e.Result);if(t){var a=JSON.parse(e.Conversion);return F(n).html(a.City+", "+a.StateShort),s(n,!1),!0}if(!t)return s(n,!1),F(n).html(""),!1}function M(e,n){return 5===e.length||(F(n).html(""),s(n,!1),!1)}function C(e,n){var t=!1,a=0,r=0,i=0,o="";try{for(r=0;r<e.length;r++)a=parseInt(e.charAt(r),10),o+=a;if(9===o.length){for(s(n,!0),i=0,r=0;r<o.length;r+=3)i+=3*parseInt(o.charAt(r),10)+7*parseInt(o.charAt(r+1),10)+parseInt(o.charAt(r+2),10);t=0!==i&&i%10==0}}catch(e){}return t}function I(n,t,a){var r=O.$module.find("#BankName");return C(n,t)?(e.ajax({type:"POST",url:"validatebankaba.php",data:e(t).serialize(),dataType:"json",success:function(e){if(a=Boolean(1===e.Result&&e.Conversion)){var n=JSON.parse(e.Conversion);s(t,!1),r.val(n.BankName)}a||r.val("")},error:function(e,n,t){console.error("The following error occurred: "+n,t)}}),!0):(r.val(""),s(t,!1),!1)}function q(n){G=e(n).serialize(),e.ajax({type:"POST",url:"checkemail.php",data:G,dataType:"json",success:function(e){1===e.Result&&(s(n,!1),u(O.$module,!1),u(O.$moduleReturning,!0)),2===e.Result&&s(n,!1)},error:function(e,n,t){console.error("The following error occurred: "+n,t)}})}function x(n){var t=e(n).closest(T.returningStep).find(T.returningFields).serialize();d(O.$moduleReturning,!0),e.ajax({type:"POST",url:"verifyemail.php",data:t+"&"+G,dataType:"json",success:function(n){Boolean(1===n.Result&&n.RID)?(Q="RID="+n.RID,O.$returningDate.html(n.LastDate),Boolean(n.Fields)&&e.each(n.Fields,function(e,n){switch(n.FieldName){case"FirstName":O.$moduleReturning.find(T.returningName).html(n.FieldValue+"!");break;case"MonthlyIncome":O.$moduleReturning.find('[name="MonthlyIncome"]').val(n.FieldValue);break;case"RequestedAmount":O.$moduleReturning.find('[name="RequestedAmount"]').val(n.FieldValue);break;default:O.$moduleReturning.find("[name="+n.FieldName+"]").val(n.FieldValue)}}),d(O.$moduleReturning,!1),l(O.$returningConfirmation,!1),l(O.$returningSubmit,!0)):d(O.$moduleReturning,!1)},error:function(e,n,t){console.error("The following error occurred: "+n,t)}})}function N(t){var a=e(t).closest(T.returningStep).find(T.returningFields).serialize();H=[],m(O.$moduleReturning,!0),O.$processingBar.animate(.99),e.ajax({type:"POST",url:"lead.php",data:a+"&"+Q,timeout:3e5,dataType:"json",success:function(t){Boolean(t.Errors&&t.Errors.length)&&(e.each(t.Errors,function(e,n){var t=O.$module.find("[name="+n.Field+"]");n.Field&&t.addClass(Z.error),-1===H.indexOf(n.Field)&&H.push(n.Field)}),P=0,m(O.$moduleReturning,!1),g(H[P])),Boolean(t.RedirectURL)&&(n.location.href=t.RedirectURL)},error:function(e,n,t){console.error("The following error occurred: "+n,t)}})}function V(){d(O.$moduleReturning,!0),e.ajax({type:"POST",url:"leadedit.php",data:G+"&"+Q,dataType:"json",success:function(n){Boolean(1===n.Result&&n.Fields)&&(O.$minLoanAmount.after('<input type="hidden" id="RID" name="RID" value="'+n.RID+'"/>'),e.each(n.Fields,function(n,t){var a=O.$module.find(T.payday+" [name="+t.FieldName+"]");switch(t.FieldName){case"SSN":var r="***-**-"+t.FieldValue.substring(5);O.$ssn1.val(r);break;case"DOB":var i=t.FieldValue.split("/");e(T.DOB_Month).val(i[0]),e(T.DOB_Day).val(i[1]),e(T.DOB_Year).val(i[2]),e(T.DOB).val(t.FieldValue);break;case"PhoneHome":var o=[];o.push(t.FieldValue.substr(0,3)),o.push(t.FieldValue.substr(3,3)),o.push(t.FieldValue.substr(6,4)),O.$phoneHome.val(o.join("-"));break;case"PhoneWork":var u=[];u.push(t.FieldValue.substr(0,3)),u.push(t.FieldValue.substr(3,3)),u.push(t.FieldValue.substr(6,4)),O.$phoneWork.val(u.join("-"));break;default:var l=t.FieldValue;"true"!==l.toLowerCase()&&"false"!==l.toLowerCase()||(l="true"===l.toLowerCase()?"1":"0"),"radio"!==a.attr("type")&&a.val(t.FieldValue),"radio"===a.attr("type")&&e('[value="'+l+'"]').prop("checked",!0)}}),e("#BankAccountNumber, #SSN, #SSN1").attr("disabled","disabled"),d(O.$moduleReturning,!1),u(O.$moduleReturning,!1),u(O.$module,!0))},error:function(e,n,t){console.error("The following error occurred: "+n,t)}})}function w(){O.$backBtn.on("click",function(){h(this)}),O.$requestedAmount.on("change",function(){var n=Number(e(this).val());k(n),O.$disclaimer.html(B(n)),O.$submitBtn.html(R(n)),O.$minLoanAmount.val(e(this).attr(j.minLoanAmount))}),O.$email.on("change",function(){e(this).valid()&&Y===T.payday&&(s(this,!0),q(this))}),O.$radioBtn.on("change",function(){c(this)}).on("click",function(){r(this,e(this).valid()),c(this)}),O.$continueBtn.on("click",function(){i(this)&&!H.length?c(this):f()}),O.$submitBtn.on("click",function(){i(this)&&S()}),O.$textFields.on("keypress",function(e){13!==e.keyCode&&13!==e.which||(e.preventDefault(),i(this)&&!H.length?c(this):f())}),O.$module.on("change",T.validatedFields,function(){r(this,e(this).valid())}),O.$annualIncomeMasked.on("change",function(){O.$annualIncome.val(p(e(this).val()))}),O.$mortgageRentMasked.on("change",function(){O.$mortgageRent.val(p(e(this).val()))}),O.$ssn1.on("change",function(){O.$ssn.val(e(this).val().replace(/\s|-/g,"").substr(0,9))}),O.$lastStepFields.on("keypress",function(e){13!==e.keyCode&&13!==e.which||(e.preventDefault(),i(this))}),O.$submitNewBnt.on("click",function(){u(O.$moduleReturning,!1),u(O.$module,!0)}),O.$submitVerifyBnt.on("click",function(){o(this)&&x(this)}),O.$submitReturningBnt.on("click",function(){if(o(this)){var n=O.$returningAmount.val(),t=O.$returningAmount.find('option[value="'+n+'"]');O.$returningMinLoanAmount.val(e(t).attr(j.minLoanAmount)),N(this)}}),O.$updateBnt.on("click",function(){V()})}function L(){b(O.$payDate),b(O.$returningPayDate),O.$zipCode.mask("00000"),O.$returningZip.mask("00000"),O.$returningSsn.mask("0000"),O.$ssn1.mask("000-00-0000"),O.$bankABA.mask("000000000"),O.$employerZip.mask("00000"),O.$phoneHome.mask("000-000-0000"),O.$phoneWork.mask("000-000-0000"),O.$mortgageRentMasked.mask("000,000",{reverse:!0}),O.$mortgageRentMasked.maskMoney({prefix:"$",thousands:",",precision:0,allowZero:!0}),O.$annualIncomeMasked.mask("00,000,000",{reverse:!0}),O.$annualIncomeMasked.maskMoney({prefix:"$",thousands:",",precision:0,allowZero:!1}),e.validator.addMethod("MortgageRentValid",function(e){e=p(e);var n=O.$mortgageRentMasked.attr(j.maxValue)||1e4;return e<=Number(n)}),e.validator.addMethod("AnnualIncomeValid",function(e){e=p(e);var n=O.$annualIncomeMasked.attr(j.minValue)||1e3,t=O.$annualIncomeMasked.attr(j.maxValue)||1e6;return e<=Number(t)&&e>=Number(n)}),e.validator.addMethod("ZipCodeValid",M),e.validator.addMethod("BankABAValid",I),O.$module.validate(U),O.$moduleReturning.validate(J)}var P,O={$module:e(".pp-form"),$moduleReturning:e(".pp-form-returning"),$moduleProcessing:e(".pp-processing")},T={step:".pp-step",continueBtn:".pp-continue-btn",backBtn:".pp-back-btn",radioBtn:'.pp-radio-buttons [type="radio"]',submitBtn:".pp-submit-btn",textFields:'input[type!="hidden"][type!="radio"]:not(.pp-dont-select), select',validatedFields:'input[type!="hidden"], select',lastStepFields:'.pp-last-step input[type!="hidden"], .pp-last-step select',focusedFields:'input[type!="hidden"], select',lastStep:".pp-last-step",disclaimer:".pp-disclaimer",requestedAmount:'input[name="RequestedAmount"]',DOB:"#DOB",DOB_Month:'[name="DOB_Month"]',DOB_Day:'[name="DOB_Day"]',DOB_Year:'[name="DOB_Year"]',payDate:"#PayDate1",email:"#Email",minLoanAmount:"#MinLoanAmount",phoneHome:"#PhoneHome",phoneWork:"#PhoneWork",employerZip:"#EmployerZip",zipCode:"#ZipCode",bankABA:"#BankABA",zipState:".pp-zip-state",ssn:"#SSN",ssn1:"#SSN1",mortgageRent:"#MortgageRent",mortgageRentMasked:"#MortgageRentMasked",annualIncome:"#AnnualIncome",annualIncomeMasked:"#AnnualIncomeMasked",payday:".payday",personal:".personal",returningStep:".pp-returning-step",returningConfirmation:".returning-confirmation",returningSubmit:".returning-submit",submitNewBnt:".pp-submit-new-btn",submitReturningBnt:".pp-submit-returning-btn",updateBnt:".pp-update-btn",returningFields:"input, select",submitVerifyBnt:".pp-verify-btn",returningZip:".pp-returning-zip",returningSsn:".pp-returning-ssn",returningDate:".pp-returning-date",returningName:".pp-returning-name",returningPayDate:".pp-returning-pay-date",returningAmount:"#RequestedAmount",returningMinLoanAmount:"#returningMinLoanAmount",processingBar:"#pp-processing-bar"},z={days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],holidayDates:["02/20/2017","05/29/2017","07/04/2017","09/04/2017","10/09/2017","11/11/2017","11/23/2017","12/25/2017"]},Z={error:"error",valid:"valid",loading:"loading",loadingSM:"loading-sm",zipState:"pp-zip-state"},j={minValue:"data-pp-min",maxValue:"data-pp-max",minLoanAmount:"data-min-value"},E={payday:"By clicking “Get Cash Now!”, I affirm that I have read, understand, and agree to the Disclaimer, Privacy Policy and Terms of Use, my click is my electronic signature, and I authorize you to share my information with lenders and other marketing partners that might use SMS messaging, autodialers or prerecorded messages to call or text me on my mobile phone or landline. I understand consent is not required to obtain a loan. I further understand that I have no obligation to accept a loan once I am connected with an available lender.",personal:"By clicking “View Offer!”, I affirm that I have read, understand, and agree to the Credit Authorization Agreement and Disclosure, Privacy Policy and Terms of Use, my click is my electronic signature, and I authorize you to share my information with lenders, lending partners, and other marketing partners that might use autodialers or prerecorded messages to call or text me on my mobile phone or landline or contact me via email. I understand consent is not required to obtain a loan. I further understand that I have no obligation to accept a loan once I am connected with an available lender or lending partner."},W={payday:"Get Cash Now!",personal:"View Offer!"},_={validFields:{},progressLine:".pp-progress-bar-line",progressNum:".pp-progress-num",radioWrap:"div.pp-radio-buttons",requiredCountSelector:".pp-required:not([disabled], .disabled)",validCountSelector:".valid.pp-required",requiredCount:0,validCount:0},H=[],U={rules:{Email:{required:!0,maxlength:50},FirstName:{required:!0,maxlength:50},LastName:{required:!0,maxlength:50},LoanPurpose:{required:!0},DOB:{required:!0},DriversLicense:{required:!0,maxlength:25},DriversLicenseState:{required:!0},Credit:{required:!0},PhoneHome:{required:!0,maxlength:12,minlength:12},Address1:{required:!0,maxlength:50},ZipCode:{required:!0,ZipCodeValid:!0,minlength:5,remote:{type:"POST",url:"validatezip.php",data:{ZipCode:function(){return O.$zipCode.val()}},beforeSend:function(){s(O.$zipCode,!0)},dataFilter:function(e){return D(JSON.parse(e),O.$zipCode)}}},MortgageRentMasked:{required:!0,MortgageRentValid:!0},AnnualIncomeMasked:{required:!0,AnnualIncomeValid:!0},EmployerName:{required:!0,maxlength:25},EmployerAddress:{required:!0,maxlength:25},EmployerZip:{required:!0,ZipCodeValid:!0,minlength:5,remote:{type:"POST",url:"validatezip.php",data:{ZipCode:function(){return O.$employerZip.val()}},beforeSend:function(){s(O.$employerZip,!0)},dataFilter:function(e){return D(JSON.parse(e),O.$employerZip)}}},PhoneWork:{required:!0,maxlength:12,minlength:12},PayDate1:{required:!0},BankABA:{required:!0,BankABAValid:!0,maxlength:9},BankName:{required:!0,maxlength:100},BankAccountNumber:{required:!0,maxlength:30},SSN1:{required:!0,maxlength:11,minlength:11}},errorPlacement:function(){return!0}},J={rules:{ZipCode:{required:!0,maxlength:5,minlength:5},SSN:{required:!0,maxlength:4,minlength:4},RequestedAmount:{required:!0},MonthlyIncome:{required:!0},PayFrequency:{required:!0},PayDate1:{required:!0}},errorPlacement:function(){return!0}},Y="",G="",Q="",K=5e3,X="",ee=function(e){for(var n=0;n<z.holidayDates.length;n++){var t=z.holidayDates[n].split("/");if(parseInt(t[0])===e.getMonth()+1&&parseInt(t[1])===e.getDate()&&parseInt(t[2])===e.getFullYear())return!0}return!1};!function(){t(),L(),w()}()}(this.jQuery,this));